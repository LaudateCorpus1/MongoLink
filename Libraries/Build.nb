(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      7869,        227]
NotebookOptionsPosition[      7362,        204]
NotebookOutlinePosition[      7720,        220]
CellTagsIndexPosition[      7677,        217]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["MongoLink", "Title",
 CellChangeTimes->{{3.655742712076886*^9, 3.655742713787754*^9}, {
  3.662411188810762*^9, 3.662411190304761*^9}}],

Cell["This is a build script for MongoLink.", "Text",
 CellChangeTimes->{{3.659860197165052*^9, 3.6598602101290007`*^9}, 
   3.6598602528829107`*^9, {3.659860302235612*^9, 3.6598603137771482`*^9}, 
   3.667940759684976*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Switch", "[", 
    RowBox[{
    "$OperatingSystem", ",", "\n", "\t", "\"\<Windows\>\"", ",", " ", "\n", 
     "\t\t", 
     RowBox[{
      RowBox[{"$CompileOptions", " ", "=", " ", "\"\<-std=c++11\>\""}], ";", 
      "\n", "\t\t", 
      RowBox[{"$MongoLib", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"\"\<mongoc-1.0.0\>\"", ",", " ", "\"\<bson-1.0.0\>\""}], 
        "}"}]}], ";"}], "\n", "\t", ",", "\n", "\t", "\"\<MacOSX\>\"", ",", 
     "\n", "\t\t", 
     RowBox[{
      RowBox[{
      "$CompileOptions", " ", "=", " ", 
       "\"\<-std=c++11 -framework Foundation -g\>\""}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"Stupid", " ", "hack"}], " ", "*)"}], "\n", "\t\t", 
      RowBox[{"$MongoInc", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
        "\"\</usr/local/include/libmongoc-1.0\>\"", ",", " ", 
         "\"\</usr/local/include/libbson-1.0\>\""}], "}"}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"$MongoLibDir", " ", "=", " ", 
       RowBox[{"{", "\"\</usr/local\>\"", "}"}]}], ";", "\n", "\t\t", 
      RowBox[{"$MongoLib", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"\"\<mongoc-1.0.0\>\"", ",", " ", "\"\<bson-1.0.0\>\""}], 
        "}"}]}], ";"}], "\n", "\t", ",", "\n", "\t", "\"\<Unix\>\"", ",", 
     "\n", "\t\t", 
     RowBox[{
      RowBox[{
      "$CompileOptions", " ", "=", " ", 
       "\"\<-std=c++11 -Wl,-rpath=/usr/local/lib\>\""}], ";", "\n", "\t\t", 
      RowBox[{"$MongoInc", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
        "\"\</usr/local/include/libmongoc-1.0\>\"", ",", " ", 
         "\"\</usr/local/include/libbson-1.0\>\""}], "}"}]}], ";", "\n", 
      "\t\t", 
      RowBox[{"$MongoLibDir", " ", "=", " ", 
       RowBox[{"{", "\"\</usr/local/lib\>\"", "}"}]}], ";", "\n", "\t\t", 
      RowBox[{"$MongoLib", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"\"\<mongoc-1.0\>\"", ",", " ", "\"\<bson-1.0\>\""}], "}"}]}],
       ";"}]}], "\n", "\t", "\n", "]"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<CCompilerDriver`\>\"", "]"}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"WL", " ", "Source"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"$CSourceDir", "  ", "=", " ", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", " ", 
      "\"\<MongoLink\>\""}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$WLSource", " ", "=", " ", 
   RowBox[{"FileNames", "[", 
    RowBox[{"\"\<*.cpp\>\"", ",", " ", 
     RowBox[{"{", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", " ", 
         "\"\<MongoLink\>\""}], "}"}], "]"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$WLInclude", " ", "=", " ", 
    RowBox[{"{", "$CSourceDir", "}"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"LibraryLinkTools", " ", "Source"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$LibLinkToolsInc", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", " ", 
        "\"\<MongoLink\>\"", ",", " ", "\"\<librarylinktools\>\""}], "}"}], 
      "]"}], "}"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", "Build", " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"$Include", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
    "$WLInclude", ",", " ", "$MongoInc", ",", " ", "$LibLinkToolsInc"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$Libraries", " ", "=", " ", 
   RowBox[{"Join", "[", "$MongoLib", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$LibraryDir", " ", "=", " ", 
    RowBox[{"Join", "[", "$MongoLibDir", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"$MongoLinkLib", " ", "=", " ", 
   RowBox[{"CreateLibrary", "[", "\n", "\t", 
    RowBox[{"$WLSource", ",", " ", "\"\<MongoLink\>\"", ",", "\n", "\t", 
     RowBox[{"\"\<IncludeDirectories\>\"", "\[Rule]", " ", "$Include"}], ",", 
     "\n", "\t", 
     RowBox[{"\"\<Libraries\>\"", " ", "\[Rule]", " ", "$Libraries"}], ",", 
     "\n", "\t", 
     RowBox[{"\"\<CompileOptions\>\"", "\[Rule]", "$CompileOptions"}], ",", 
     "\n", "\t", 
     RowBox[{
     "\"\<LibraryDirectories\>\"", " ", "\[Rule]", " ", "$LibraryDir"}], ",", 
     "\n", "\t", 
     RowBox[{"\"\<Language\>\"", " ", "->", " ", "\"\<C++\>\""}], ",", "\n", 
     "\t", 
     RowBox[{"\"\<Debug\>\"", " ", "\[Rule]", " ", "True"}], ",", "\n", "\t", 
     
     RowBox[{"\"\<CleanIntermediate\>\"", "\[Rule]", " ", "True"}]}], "\n", 
    "]"}]}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Copy", " ", "built", " ", "dynamic", " ", "lib", " ", "to", " ", "lib", 
    " ", "folder", " ", "in", " ", "package"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"$MongoPackageLibDir", " ", "=", " ", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ParentDirectory", " ", "@", " ", 
       RowBox[{"NotebookDirectory", "[", "]"}]}], ",", " ", 
      "\"\<LibraryResources\>\"", ",", " ", "$SystemID"}], "}"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$MongoPackageLib", " ", "=", " ", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"$MongoPackageLibDir", ",", " ", 
       RowBox[{"FileNameTake", "@", "$MongoLinkLib"}]}], "}"}], "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"FileExistsQ", "@", "$MongoPackageLib"}], ",", " ", 
    RowBox[{"DeleteFile", "@", "$MongoPackageLib"}]}], "]"}], ";", " ", 
  RowBox[{"(*", " ", "Overwrite", " ", "*)"}], "\n", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"FileExistsQ", "@", "$MongoPackageLibDir"}]}], ",", " ", 
    RowBox[{"CreateDirectory", "@", "$MongoPackageLibDir"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CopyFile", "[", 
    RowBox[{"$MongoLinkLib", ",", " ", "$MongoPackageLib"}], "]"}], ";"}], 
  "\n"}], "\n", 
 RowBox[{"LibraryLoad", "@", 
  "$MongoPackageLib"}], "\n", "LibraryLink`$LibraryError"}], "Code"],

Cell[BoxData["\<\"\"\>"], "Print"],

Cell[BoxData["\<\"/Users/sebastianb/Library/Mathematica/SystemFiles/\
LibraryResources/MacOSX-x86-64/MongoLink.dylib\"\>"], "Output"],

Cell[BoxData["None"], "Output"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1234, 800},
WindowMargins->{{29, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 27, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 141, 2, 92, "Title"],
Cell[724, 26, 223, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[972, 33, 6155, 160, 906, "Code"],
Cell[7130, 195, 34, 0, 21, "Print"],
Cell[7167, 197, 133, 1, 28, "Output"],
Cell[7303, 200, 31, 0, 28, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

